<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Creating a Bare Bones OPAC - Systems Librarianship</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Entry level book on systems librarianship.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="p1-systems-librarianship.html"><strong aria-hidden="true">1.</strong> Systems Librarianship</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="01-history-linux-unix.html"><strong aria-hidden="true">1.1.</strong> History of Unix and Linux</a></li><li class="chapter-item expanded "><a href="02-what-is-linux.html"><strong aria-hidden="true">1.2.</strong> What is Linux?</a></li><li class="chapter-item expanded "><a href="03-what-is-sysadmin.html"><strong aria-hidden="true">1.3.</strong> What is Systems Administration?</a></li><li class="chapter-item expanded "><a href="04-what-is-syslib.html"><strong aria-hidden="true">1.4.</strong> What is Systems Librarianship?</a></li></ol></li><li class="chapter-item expanded "><a href="p2-using-gcloud.html"><strong aria-hidden="true">2.</strong> Using Google Cloud (gcloud)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="05-using-gcloud-virtual-machines.html"><strong aria-hidden="true">2.1.</strong> Using gcloud for Virtual Machines</a></li></ol></li><li class="chapter-item expanded "><a href="p3-learning-the-command-line.html"><strong aria-hidden="true">3.</strong> Learning the Command Line</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="06-learn-the-cli.html"><strong aria-hidden="true">3.1.</strong> Learn the CLI</a></li><li class="chapter-item expanded "><a href="08-learn-nano.html"><strong aria-hidden="true">3.2.</strong> Using the Nano Text Editor</a></li><li class="chapter-item expanded "><a href="09-searching-with-grep.html"><strong aria-hidden="true">3.3.</strong> Searching with grep</a></li><li class="chapter-item expanded "><a href="10-managing-software.html"><strong aria-hidden="true">3.4.</strong> Managing Software</a></li></ol></li><li class="chapter-item expanded "><a href="p4-project-management.html"><strong aria-hidden="true">4.</strong> Project Management and Version Control</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="12-learn-git-and-github.html"><strong aria-hidden="true">4.1.</strong> Learn Git and GitHub</a></li></ol></li><li class="chapter-item expanded "><a href="p5-creating-a-lamp-server.html"><strong aria-hidden="true">5.</strong> Creating a LAMP Server</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="14-installing-the-apache-web-server.html"><strong aria-hidden="true">5.1.</strong> Installing the Apache Web Server</a></li><li class="chapter-item expanded "><a href="15-installing-configuring-php.html"><strong aria-hidden="true">5.2.</strong> Installing and Configuring PHP</a></li><li class="chapter-item expanded "><a href="16-installing-configuring-mysql.html"><strong aria-hidden="true">5.3.</strong> Installing and Configuring MySQL</a></li><li class="chapter-item expanded "><a href="16.5-basic-opac.html" class="active"><strong aria-hidden="true">5.4.</strong> Creating a Bare Bones OPAC</a></li><li class="chapter-item expanded "><a href="16.8-basic-opac-admin.html"><strong aria-hidden="true">5.5.</strong> Creating a Bare Bones Cataloging Module</a></li></ol></li><li class="chapter-item expanded "><a href="p6-installing-content-management-systems.html"><strong aria-hidden="true">6.</strong> Installing Content Management Systems</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="17-install-wordpress.html"><strong aria-hidden="true">6.1.</strong> Install Wordpress</a></li><li class="chapter-item expanded "><a href="18-install-omeka.html"><strong aria-hidden="true">6.2.</strong> Install Omeka</a></li></ol></li><li class="chapter-item expanded "><a href="p7-installing-an-ILS.html"><strong aria-hidden="true">7.</strong> Installing an Integrated Library System</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="20-install-koha.html"><strong aria-hidden="true">7.1.</strong> Install Koha</a></li></ol></li><li class="chapter-item expanded "><a href="p8-conclusion.html"><strong aria-hidden="true">8.</strong> Conclusion</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Systems Librarianship</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/cseanburns/systems_librarianship" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="creating-a-bare-bones-opac"><a class="header" href="#creating-a-bare-bones-opac">Creating a Bare Bones OPAC</a></h1>
<p>In this section,
we're going to create a bare bones and
very basic OPAC.
The idea is simply to acquire an
intuition and understanding of how data
from a relational database is
retrieved and entered using
various technologies.</p>
<p>A real integrated library system
is much more complex than what
we are doing here, but
the fundamental ideas are the same:
we enter data into a database,
and we retrieve data from a database.
And then a whole slew of other technologies
are added to present the data in a user-friendly
way: HTML, CSS, and JavaScript.</p>
<p>Integrated library systems (ILS) also provide
multiple modules for patron management,
acquisitions, circulation, cataloging,
serials management, authorities, reporting,
and so forth
(see <a href="koha-about">Koha: About</a>].
All of those modules rely on some kind
of underlying relational database,
like MySQL
(which is what Koha uses).
And this results in a complex,
interconnected set of tables.
We are working with only one table
in our database,
the <strong>books</strong> table.
In reality, an ILS will rely on
dozens of tables.</p>
<p>In the prior section,
we created a MySQL database
called <strong>opacdb</strong>.
That database has one table,
called <strong>books</strong>.
Then we created a file that
used PHP to retrieve the data
from the <strong>books</strong> table
and present it on a web page.</p>
<p>In this section,
we are going to use different
PHP code that will allow us
to search the <strong>books</strong> table
and retrieve results based
on our search query.
In this way,
we are more closely mimicking
an OPAC,
even though we're still far from
creating anything that's full fledged.</p>
<h2 id="creating-the-html-page-and-a-php-search-page"><a class="header" href="#creating-the-html-page-and-a-php-search-page">Creating the HTML Page and a PHP Search Page</a></h2>
<p>The first thing we do is
create a basic HTML page that
contains a form for entering queries.
We'll call this HTML page with the form
<strong>opacbb.html</strong> (just a made up name).
When a user clicks on the submit button
in the form,
the form will activate a PHP script
called <strong>search.php</strong>.
That <strong>search.php</strong> will establish
a connection to the OPAC database
that we already have created.
Our PHP script will contain a special
MySQL query that will allow us to
search all the fields in our <strong>books</strong> table.
The it will iterate through each row of
the <strong>books</strong> table and return results
that match our query.
We also add two date fields to our form
to limit results by publication dates,
which we labeled as <strong>copyright</strong> in our
MySQL <strong>books</strong> table.</p>
<h3 id="html-form"><a class="header" href="#html-form">HTML Form</a></h3>
<p>Here is the HTML for our search page:</p>
<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;title&gt;MySQL Server Example&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;h1&gt;A Basic OPAC&lt;/h1&gt;

&lt;p&gt;In the form below,
&lt;b&gt;optionally&lt;/b&gt; enter text in the search field.
You can search by author, title, or publisher.
Capitalization is not necessary.
It's okay to enter partial information,
like part of an author's, title's, or publisher's name.&lt;/p&gt;

&lt;p&gt;The date fields are &lt;b&gt;required&lt;/b&gt;.
You can use the date fields to limit results.
I added some extra records,
which you can view to know what you can query:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://11.111.222.222/opac.php&quot;&gt;http://11.111.222.222/opac.php&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This is very much a toy, stripped down OPAC.
The records are basic.
Not only do they not conform to MARC,
but they don't even conform to something
as simple as Dublin Core.
I also don't provide options
to select different fields,
like author, title, or publisher fields.
Instead the search field below searches
all the fields in our &lt;b&gt;books&lt;/b&gt; table.
The key idea is to get a sense,
an intuition, of how an OPAC works, though.&lt;/p&gt;

&lt;h2&gt;My Basic Library OPAC&lt;/h2&gt;
&lt;form method=&quot;post&quot; action=&quot;search.php&quot;&gt;
    &lt;label for=&quot;search&quot;&gt;Search:&lt;/label&gt;
    &lt;input type=&quot;text&quot; name=&quot;search&quot; id=&quot;search&quot;&gt;
    &lt;br&gt;
    &lt;label for=&quot;start_date&quot;&gt;Start Date:&lt;/label&gt;
    &lt;input type=&quot;date&quot; name=&quot;start_date&quot; id=&quot;start_date&quot;&gt;
    &lt;br&gt;
    &lt;label for=&quot;end_date&quot;&gt;End Date:&lt;/label&gt;
    &lt;input type=&quot;date&quot; name=&quot;end_date&quot; id=&quot;end_date&quot;&gt;
    &lt;br&gt;
    &lt;input type=&quot;submit&quot; value=&quot;Search&quot;&gt;
&lt;/form&gt;


&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3 id="php-search-script"><a class="header" href="#php-search-script">PHP Search Script</a></h3>
<p>Here is the PHP for our search script:</p>
<pre><code>&lt;?php
// Load MySQL credentials
require_once 'login.php';

// Establish connection
$conn = mysqli_connect($db_hostname, $db_username, $db_password) or
  die(&quot;Unable to connect&quot;);

// Open database
mysqli_select_db($conn, $db_database) or
  die(&quot;Could not open database '$db_database'&quot;);

// Check if search query was submitted
if (isset($_POST['search'])) {
    // Sanitize user input to prevent SQL injection attacks
    $search = mysqli_real_escape_string($conn, $_POST['search']);

    // Get the start and end dates for the date range
    $start_date = mysqli_real_escape_string($conn, $_POST['start_date']);
    $end_date = mysqli_real_escape_string($conn, $_POST['end_date']);

    // Build the MySQL query with a WHERE
    // clause that includes the date range filter
    $query = &quot;SELECT * FROM books WHERE
	    (author LIKE '%$search%' OR
		title LIKE '%$search%' OR
		publisher LIKE '%$search%') AND
		copyright BETWEEN '$start_date' AND '$end_date'&quot;;

    // Execute the query
    $result = mysqli_query($conn, $query);

    // Check if any results were returned
    if (mysqli_num_rows($result) &gt; 0) {
        // Loop through the results and output them
        while ($row = mysqli_fetch_assoc($result)) {
            echo &quot;ID: &quot; . $row[&quot;id&quot;] . &quot;&lt;br&gt;&quot;;
            echo &quot;Author: &quot; . $row[&quot;author&quot;] . &quot;&lt;br&gt;&quot;;
            echo &quot;Title: &quot; . $row[&quot;title&quot;] . &quot;&lt;br&gt;&quot;;
            echo &quot;Publisher: &quot; . $row[&quot;publisher&quot;] . &quot;&lt;br&gt;&quot;;
            echo &quot;Copyright: &quot; . $row[&quot;copyright&quot;] . &quot;&lt;br&gt;&lt;br&gt;&quot;;
        }
    } else {
        echo &quot;No results found.&quot;;
    }

    // Free up memory by closing the MySQL result set
    mysqli_free_result($result);
}

// Close the MySQL connection
mysqli_close($conn);

echo &quot;&lt;p&gt;Return to search page: &lt;a href='http://11.111.222.222/opacbb.php'&gt;http://11.111.222.222/opacbb.php&lt;/a&gt;&lt;/p&gt;&quot;;

?&gt;
</code></pre>
<h2 id="modifications"><a class="header" href="#modifications">Modifications</a></h2>
<p>Replace my IP address (11.111.222.222) above
with your IP address.
Add more records,
using MySQL,
to your <strong>books</strong> table,
and test your queries.</p>
<p>To add records to your <strong>books</strong> table,
recall that we used the <strong>insert into</strong>
MySQL statements.
Here's the example from the prior lesson.
Use it to add titles that are of interest to you.</p>
<p>First connect to the MySQL server:</p>
<pre><code>mysql -u opacuser -p
</code></pre>
<p>Then run the <code>insert</code> command with
the data for the new records:</p>
<pre><code>insert into books
(author, title, publisher, copyright) values
('Emma Donoghue', 'Room', 'Little, Brown \&amp; Company', '2010-08-06'),
('Zadie Smith', 'White Teeth', 'Hamish Hamilton', '2000-01-27');
</code></pre>
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<p>In this lesson,
we created a very bare bones OPAC
simply to express the fundamental idea
of how data is stored and retrieved on the web.
In reality, what separates an OPAC,
or a discovery service in a modern
integrated library system
or library service platform,
from other databases on the web
is the structure of the records
that are stored in the relational database.
Such records are structured using MARC.
Our records are very simply structured,
but still,
I hope this helps in creating an intuition
about how OPACs and like function.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="16-installing-configuring-mysql.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="16.8-basic-opac-admin.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="16-installing-configuring-mysql.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="16.8-basic-opac-admin.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" charset="utf-8"></script>
        <script src="mark.min.js" charset="utf-8"></script>
        <script src="searcher.js" charset="utf-8"></script>

        <script src="clipboard.min.js" charset="utf-8"></script>
        <script src="highlight.js" charset="utf-8"></script>
        <script src="book.js" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
